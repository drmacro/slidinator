<project name="dita2slideset" default="dita2slideset"
  >
  
  <!-- test to see where the plugin is located, plugins or demo -->
  <dirname property="slideset.dir" file="${ant.file.dita2slideset}"/>
	
	<!-- Controls debugging within the XSLTs. Set to "true" to turn on debugging: -->
	<property name="debug" value="false"/>
	
	<property name="slideset.temp.dir" value="${dita.temp.dir}${file.separator}slideset_temp"/>
	<!-- This is the name of the slideset "dot" program, which is used to generate
	     graph pictures from DOT (.gv) files. If it is not in your system PATH then
	     set this property to the absolute path to the executable.
	  -->
	<property name="slidesetArgs" value=""/>

	<target name="dita2slideset"
    unless="noMap"
    xmlns:dita="http://dita-ot.sourceforge.net"
		dita:depends="build-init, preprocess,slideset"
    dita:extension="depends org.dita.dost.platform.InsertDependsAction">
  </target>
  
  <target name="slideset"
    unless="noMap"
    depends="dita.map.slideset"/>
	  
    
  <target name="dita.map.slideset.init"
    description="Init properties for slideset">
    <basename property="dita.map.toc.root"
      file="${dita.input.filename}"
      suffix=".ditamap" />
    <condition property="args.slideset.toc" value="${dita.map.toc.root}">
      <not>
        <isset property="args.slideset.toc" />
      </not>
    </condition>
    <condition property="out.ext" value=".gv">
      <not>
        <isset property="out.ext" />
      </not>
    </condition>
    <condition property="noPlugin">
      <equals arg1="${dita.slideset.plugin}" arg2="no" />
    </condition>


  </target>
  

  
  <target name="dita.map.slideset" depends="dita.map.slideset.init" 
  	description="Generate slideset data files from the input map">
  	
  	<mkdir dir="${slideset.temp.dir}"/>
  	<makeurl file="${slideset.temp.dir}" property="slideset.xslt.outdir"/>
  	<makeurl file="${dita.temp.dir}" property="slideset.xslt.tempdir"/>
  	
  	<property name="map2slideset.style" location="${slideset.dir}/xsl/map2slideset.xsl"/>
		<property name="slideset.result.filename" value="${dita.map.filename.root}.${slideset.output.format}"/>

    <xslt processor="trax"
      basedir="${dita.temp.dir}"
      destdir="${output.dir}"
      includesfile="${dita.temp.dir}${file.separator}fullditamap.list"
      classpathref="dost.class.path"
      style="${map2slideset.style}">
      <param name="debug" expression="${debug}"/>
     	<param name="tempdir" expression="${slideset.xslt.tempdir}"/>
    	<param name="outdir" expression="${output.dir}"/>
    	<param name="rawPlatformString" expression="${os.name}"/>

    	<!-- Parameters from dita2xhtml and similar transtypes: -->   
      <param name="WORKDIR" expression="${workdir}" if="workdir"/>
      <param name="DRAFT" expression="${args.draft}" if="args.draft"></param>
      <param name="ARTLBL" expression="${args.artlbl}" if="args.artlbl"></param>
    	<param name="OUTPUTDIR" expression="${output.dir}"/>
    </xslt>

  	<!-- Run the slideset2pptx Java application -->

  </target>
  
  <target name="slideset.copy.graphics" 
	  description="Copies graphics from input to the slideset output directory based on the graphic map generated during slideset generation">
  	<ant antfile="${slideset.temp.dir}/copy-graphics.xml"  		
  		>
  	</ant>
	</target>
	
</project>
